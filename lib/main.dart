import 'dart:typed_data';

import 'package:crypto_toolkit/algorithms/kyber/kyber.dart';
import 'package:crypto_toolkit/router/app_router.dart';
import 'package:flutter/material.dart';


void main() {
  // runApp(const App());
  Kyber kyber = Kyber.kem512();

  var seed = Uint8List.fromList([
    0x0, 0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x7, 0x8, 0x9, 0xA, 0xB, 0xC, 0xD, 0xE, 0xF,
    0x0, 0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x7, 0x8, 0x9, 0xA, 0xB, 0xC, 0xD, 0xE, 0xF,
    0x0, 0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x7, 0x8, 0x9, 0xA, 0xB, 0xC, 0xD, 0xE, 0xF,
    0x0, 0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x7, 0x8, 0x9, 0xA, 0xB, 0xC, 0xD, 0xE, 0xF,
  ]);
  var (pk, sk) = kyber.generateKeys(seed);

  var nonce = Uint8List.fromList([
  0xF, 0xE, 0xD, 0xC, 0xB, 0xA, 0x9, 0x8, 0x7, 0x6, 0x5, 0x4, 0x3, 0x2, 0x1, 0x0,
  0xF, 0xE, 0xD, 0xC, 0xB, 0xA, 0x9, 0x8, 0x7, 0x6, 0x5, 0x4, 0x3, 0x2, 0x1, 0x0,
  ]);
  var (cipher, key1) = kyber.encapsulate(pk, nonce);

  var key2 = kyber.decapsulate(cipher, sk);

  print("pk: ${pk.serialize()}\n");
  print("sk: ${sk.serialize()}\n");
  print("cipher: ${cipher.serialize()}\n");
  print("key1: $key1\n");
  print("key2: $key2\n");
}

class App extends StatelessWidget {
  const App({super.key});

  @override
  Widget build(BuildContext context) {
    return MaterialApp.router(
      routerConfig: router,
      title: "Crypto toolkit",
      theme: ThemeData(
        useMaterial3: true,
        colorSchemeSeed: Colors.lightBlueAccent
      ),
    );
  }

}